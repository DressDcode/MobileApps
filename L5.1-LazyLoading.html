<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lazy Loading Demo (Images, Backgrounds, Iframes)</title>
  <style>
    :root { --gap: 48px; --maxw: 900px; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5; margin: 0; color: #222; background: #f7f7f8;
    }
    header, section { max-width: var(--maxw); margin: 0 auto; padding: 24px; }
    header { padding-top: 48px; }
    h1, h2 { margin: 0 0 12px; }
    p { margin: 0 0 12px; }
    .spacer { height: var(--gap); }
    .card {
      background: #fff; border-radius: 14px; box-shadow: 0 10px 24px rgba(0,0,0,.07);
      overflow: hidden; border: 1px solid #eee; margin-bottom: 24px;
    }
    .card__body { padding: 16px 16px 20px; }

    /* Responsive media */
    img, iframe { display: block; width: 100%; height: auto; }
    .media-wrap { position: relative; overflow: hidden; }
    .media-wrap.ratio-16x9 { aspect-ratio: 16 / 9; }
    .media-wrap.ratio-3x2  { aspect-ratio: 3 / 2; }
    .blur-up {
      filter: blur(12px); transform: scale(1.02);
      transition: filter .4s ease, transform .4s ease;
      background: #eee;
    }
    .blur-up.is-loaded { filter: blur(0); transform: none; }

    /* Lazy background blocks */
    .bg-block {
      height: 320px; border-radius: 12px; background: #e9ecef;
      background-size: cover; background-position: center;
      display: grid; place-items: center; color: #333; font-weight: 600;
    }
    .note {
      background: #fff8e1; border: 1px solid #ffe082; color: #795548;
      padding: 10px 12px; border-radius: 10px;
    }

    /* Small helper for code-like text */
    code { background: #f2f2f2; padding: 2px 6px; border-radius: 6px; }
  </style>
</head>
<body>

  <header>
    <h1>Lazy Loading Demo</h1>
    <p>Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Îµ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ (<code>loading="lazy"</code>), background images (IntersectionObserver) ÎºÎ±Î¹ iframe (YouTube).</p>
    <p class="note">
      Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: Î Î¿Î»Î»Î¬ ÎµÎ¹Î´Î·ÏƒÎµÎ¿Î³ÏÎ±Ï†Î¹ÎºÎ¬ sites (Ï€.Ï‡. protothema.gr) Î´ÎµÎ½ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Î½Î± Ï„Î± ÎµÎ½ÏƒÏ‰Î¼Î±Ï„ÏÏƒÎµÎ¹Ï‚ ÏƒÎµ <code>&lt;iframe&gt;</code> Î»ÏŒÎ³Ï‰
      Ï€Î¿Î»Î¹Ï„Î¹ÎºÏÎ½ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ (<code>X-Frame-Options</code> Î® <code>CSP frame-ancestors</code>), Î¿Ï€ÏŒÏ„Îµ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Ï€Î·Î³Î® Ï€Î¿Ï… Ï„Î¿ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ (YouTube, Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… page Îº.Î»Ï€.).
    </p>
  </header>

  <section>
    <h2>1) Lazy loading ÎµÎ¹ÎºÏŒÎ½Ï‰Î½ Î¼Îµ native attribute</h2>

    <div class="card">
      <div class="media-wrap ratio-3x2">
        <!-- Î§Î±Î¼Î·Î»Î®Ï‚ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚ preview Ï‰Ï‚ Î±ÏÏ‡Î¹ÎºÏŒ src Î³Î¹Î± blur-up effect -->
        <img
          class="blur-up"
          src="https://picsum.photos/48/32?random=1"
          data-src="https://picsum.photos/1200/800?random=1"
          alt="Î”ÎµÎ¯Î³Î¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ 1"
          width="1200" height="800"
          loading="lazy"
          decoding="async"
          />
      </div>
      <div class="card__body">
        <p>Î— ÎµÎ¹ÎºÏŒÎ½Î± Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹ Ï„ÎµÎ¼Ï€Î­Î»Î¹ÎºÎ± ÏŒÏ„Î±Î½ Ï€Î»Î·ÏƒÎ¹Î¬ÏƒÎµÎ¹ ÏƒÏ„Î¿ viewport. ÎŸÏÎ¯Î¶Î¿Ï…Î¼Îµ <code>width</code>/<code>height</code> Î³Î¹Î± ÏƒÏ„Î±Î¸ÎµÏÏŒ layout.</p>
      </div>
    </div>

    <div class="card">
      <div class="media-wrap ratio-3x2">
        <img
          class="blur-up"
          src="https://picsum.photos/48/32?random=2"
          data-src="https://picsum.photos/1200/800?random=2"
          alt="Î”ÎµÎ¯Î³Î¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ 2"
          width="1200" height="800"
          loading="lazy"
          decoding="async"
          srcset="
            https://picsum.photos/600/400?random=2 600w,
            https://picsum.photos/900/600?random=2 900w,
            https://picsum.photos/1200/800?random=2 1200w"
          sizes="(max-width: 700px) 100vw, 700px"
        />
      </div>
      <div class="card__body">
        <p>ÎœÎµ <code>srcset</code> & <code>sizes</code> Î¿ browser ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· Î±Î½Î¬Î»Ï…ÏƒÎ· Î±Î½Î¬ ÏƒÏ…ÏƒÎºÎµÏ…Î®.</p>
      </div>
    </div>

    <div class="spacer"></div>

    <h2>2) Lazy loading background-images Î¼Îµ IntersectionObserver</h2>
    <div class="card">
      <div
        class="bg-block js-lazy-bg"
        data-bg="https://picsum.photos/1400/900?random=3"
        aria-label="Background ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¿Ï… Ï†Î¿ÏÏ„ÏÎ½ÎµÎ¹ ÏŒÏ„Î±Î½ ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯"
      >
        Î˜Î± Ï†Î¿ÏÏ„Ï‰Î¸Ï ÏŒÏ„Î±Î½ ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Ï ğŸ‘‹
      </div>
      <div class="card__body">
        <p>Î“Î¹Î± background ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ native <code>loading</code>. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ JavaScript Î³Î¹Î± Î½Î± Î¿ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ <code>background-image</code> ÏŒÏ„Î±Î½ Ï„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Î¼Ï€ÎµÎ¹ ÏƒÏ„Î¿ viewport.</p>
      </div>
    </div>

    <div class="spacer"></div>

    <h2>3) Lazy loading iframe (YouTube)</h2>
    <div class="card">
      <div class="media-wrap ratio-16x9">
        <!-- Poster/placeholder Î¼Î­Ï‡ÏÎ¹ Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Ï„Î¿ iframe -->
        <img
          class="blur-up"
          src="https://i.ytimg.com/vi/dQw4w9WgXcQ/hqdefault.jpg"
          alt="Video placeholder"
          width="1280" height="720"
          loading="lazy"
          decoding="async"
        />
        <!-- Î¤Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ iframe Î¼Ï€Î±Î¯Î½ÎµÎ¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬ ÏŒÏ„Î±Î½ Î³Î¯Î½ÎµÎ¹ intersect -->
        <iframe
          class="js-lazy-iframe"
          title="YouTube video player"
          data-src="https://www.youtube.com/embed/dQw4w9WgXcQ?rel=0"
          loading="lazy"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen
          style="position:absolute; inset:0; border:0;"
        ></iframe>
      </div>
      <div class="card__body">
        <p>Î¤Î¿ <code>iframe</code> Î­Ï‡ÎµÎ¹ <code>loading="lazy"</code>. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ¼Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ„Î¿ <code>data-src</code> ÎºÎ±Î¹ Ï„Î· Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ ÏƒÎµ <code>src</code> ÏŒÏ„Î±Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯, ÏÏƒÏ„Îµ Î½Î± ÎºÎ±Î¸Ï…ÏƒÏ„ÎµÏÎµÎ¯ ÎºÎ±Î¹ Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï„Î¿Ï… Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï….</p>
      </div>
    </div>
  </section>

  <script>
    // Helper: Ï€ÏÎ¿Ï‰Î¸Î¿ÏÎ¼Îµ Ï„Î¿ data-src => src ÎºÎ±Î¹ Î±Ï†Î±Î¹ÏÎ¿ÏÎ¼Îµ blur ÏŒÏ„Î±Î½ Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹
    function upgradeImage(img) {
      if (img.dataset.src) img.src = img.dataset.src;
      if (img.complete) {
        img.classList.add('is-loaded');
      } else {
        img.addEventListener('load', () => img.classList.add('is-loaded'), { once: true });
      }
    }

    // 1) Î•Î¹ÎºÏŒÎ½ÎµÏ‚ Î¼Îµ data-src (blur-up)
    const lazyImgs = Array.from(document.querySelectorAll('img.blur-up[data-src]'));

    // 2) Background blocks
    const lazyBgs = Array.from(document.querySelectorAll('.js-lazy-bg[data-bg]'));

    // 3) Iframes Î¼Îµ data-src
    const lazyIframes = Array.from(document.querySelectorAll('iframe.js-lazy-iframe[data-src]'));

    // Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ IntersectionObserver, ÎºÎ¬Î½Îµ lazy Î¼ÏŒÎ½Î¿ ÏŒÏ„Î±Î½ Î­ÏÎ¸Î¿Ï…Î½ ÎºÎ¿Î½Ï„Î¬
    if ('IntersectionObserver' in window) {
      const io = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (!entry.isIntersecting) return;

          const el = entry.target;

          if (el.tagName === 'IMG') {
            upgradeImage(el);
          } else if (el.classList.contains('js-lazy-bg')) {
            el.style.backgroundImage = `url("${el.dataset.bg}")`;
          } else if (el.tagName === 'IFRAME') {
            el.src = el.dataset.src;
          }

          obs.unobserve(el);
        });
      }, { rootMargin: '200px 0px 200px 0px' });

      lazyImgs.forEach(i => io.observe(i));
      lazyBgs.forEach(b => io.observe(b));
      lazyIframes.forEach(f => io.observe(f));

    } else {
      // Fallback: Ï€Î±Î»Î¹ÏŒÏ„ÎµÏÎ¿Î¹ browsers â€” Ï†ÏŒÏÏ„Ï‰ÏƒÎµ Ï„Î± Ï€Î¬Î½Ï„Î± Î±Î¼Î­ÏƒÏ‰Ï‚
      lazyImgs.forEach(upgradeImage);
      lazyBgs.forEach(b => b.style.backgroundImage = `url("${b.dataset.bg}")`);
      lazyIframes.forEach(f => f.src = f.dataset.src);
    }
  </script>

  <noscript>
    <section style="max-width:900px;margin:0 auto;padding:24px">
      <p><strong>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·:</strong> Î— ÏƒÎµÎ»Î¯Î´Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ JavaScript Î³Î¹Î± lazy loading.
      ÎœÎµ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ JS, Î¿Î¹ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ Ï†Î¿ÏÏ„ÏÎ½Î¿Ï…Î½ Î±Ï€ÏŒ Ï„Î± <code>src</code> ÎºÎ±Î¹ Ï„Î± background
      Î´ÎµÎ½ Î¸Î± Î³Î¯Î½Î¿Ï…Î½ lazy.</p>
    </section>
  </noscript>
</body>
</html>
